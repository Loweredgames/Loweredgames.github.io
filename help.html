<!DOCTYPE html>
<html lang="it">
<head>
    <!-- Meta tags per SEO e responsività -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loweredgames Changelog Maps - Risoluzione dei problemi</title>
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="images/icons/favicon.ico">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="translate.js"></script>
</head>
<body>
    <!-- Header con titolo principale e navigazione -->
    <header>
        <h1 onclick="window.location.href='index.html'">Loweredgames Changelog Maps</h1>
    </header>

    <!-- Contenuto principale -->
    <main>
        <!-- Intestazione del post con immagine e metadati -->
        <div id="post-header" class="post-header">
        </div>
        
        <!-- Contenuto Risoluzione dei problemi da Markdown -->
        <div id="help-content" class="changelog">
            <div class="loading">Caricamento delle Risoluzione dei problemi in corso...</div>
        </div>
        <script>
            // Gestione delle immagini responsive
            function handleImages() {
                document.querySelectorAll('#help-content img').forEach(img => {
                    img.style.maxWidth = '100%';
                    img.style.height = 'auto';
                    img.loading = 'lazy';
                    img.decoding = 'async';
                });
            }

            // Osserva i cambiamenti del contenuto
            const observer = new MutationObserver(handleImages);
            observer.observe(document.getElementById('help-content'), { 
                childList: true, 
                subtree: true 
            });
        </script>

        <!-- Freccia laterale: appare quando si scorre il contenuto -->
    </main>

    <a id="scroll-arrow" href="#" title="Torna all'inizio" aria-label="Torna all'inizio">
        <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
            <path d="M4 12l1.41 1.41L11 7.83V20h2V7.83l5.59 5.58L20 12l-8-8-8 8z" />
        </svg>
    </a>
    </main>

    <!-- Sezione Discord -->
    <section class="discord-section">
        <div class="discord-container">
            <h2>Unisciti alla mia community Discord!</h2>
            <p>Per supporto o problemi, aggiornamenti e discussioni in tempo reale...</p>
            <a href="https://discord.gg/T6PHxhznJ6" class="discord-button">
                <img src="images/social_logo/Discord.png" alt="Discord">
                Entra nel Server
            </a>
        </div>
    </section>
        
    <!-- Footer con copyright e Link-->
    <footer>
        <div class="footer-content">
            <h3>Link:</h3>
            <div class="social-icons">
                <a href="https://github.com/Loweredgames/" class="social-icon" title="GitHub">
                    <img src="images/social_logo/Github.png" alt="GitHub">
                </a>
                <a href="https://modrinth.com/user/Loweredgames/" class="social-icon" title="Modrinth">
                    <img src="images/social_logo/Modrinth.png" alt="Modrinth">
                </a>
                <a href="https://www.planetminecraft.com/member/loweredgames/" class="social-icon" title="PlanetMinecraft">
                    <img src="images/social_logo/PlanetMinecraft.png" alt="PlanetMinecraft">
                </a>
                <a href="https://www.curseforge.com/members/loweredgamesdev/projects/" class="social-icon" title="CurseForge">
                    <img src="images/social_logo/CursedForge.png" alt="CurseForge">
                </a>
                <a href="https://smithed.net/Loweredgames/" class="social-icon" title="Smithed">
                    <img src="images/social_logo/Smithed.png" alt="Smithed">
                </a>
                <a href="https://crowdin.com/profile/" class="social-icon" title="Crowdin">
                    <img src="images/social_logo/Crowdin.png" alt="Crowdin">
                </a>
            </div>
            <p>&copy; <a href="license.html">Loweredgames Copyright</a> - Tutti i diritti riservati.</p>
        </div>
    </footer>

    <script>
        // Funzione per caricare e convertire il file Markdown
        async function loadHelp() {
            try {
                const response = await fetch('help.md');
                if (!response.ok) {
                    throw new Error(`Errore nel caricamento: ${response.status}`);
                }
                
                const markdownText = await response.text();
                const htmlContent = marked.parse(markdownText);
                
                document.getElementById('help-content').innerHTML = htmlContent;
                // Notifica che il contenuto è stato inserito (usato dallo script della freccia)
                document.dispatchEvent(new Event('changelog:loaded'));
            } catch (error) {
                console.error('Errore:', error);
                document.getElementById('help-content').innerHTML = `
                    <div class="error-message">
                        <img src="https://placehold.co/150x150/2d2d2d/ff0000/png?text=⚠" alt="Error">
                        <h2>Errore nel caricamento</h2>
                        <p>Non è stato possibile caricare le Risoluzione dei problemi.</p>
                        <p><em>Errore: ${error.message}</em></p>
                    </div>
                `;
            }
        }

        // Carica le Risoluzione dei problemi quando la pagina è pronta
        document.addEventListener('DOMContentLoaded', loadHelp);
    </script>
    <script>
        (function(){
            const arrow = document.getElementById('scroll-arrow');
            const content = document.getElementById('help-content');
            const postHeader = document.getElementById('post-header');

            if (!arrow || !content) return;

            function isContainerScrollable(el) { return el && el.scrollHeight > el.clientHeight; }

            function updateArrow() {
                const titleEl = postHeader ? postHeader.querySelector('.post-title') : null;
                if (titleEl) {
                    const titleRect = titleEl.getBoundingClientRect();
                    const showWhenPx = 56;
                    if (titleRect.bottom <= showWhenPx) arrow.classList.add('visible');
                    else arrow.classList.remove('visible');
                    return;
                }

                const threshold = 80;
                if (isContainerScrollable(content)) {
                    if (content.scrollTop > threshold) arrow.classList.add('visible');
                    else arrow.classList.remove('visible');
                    return;
                }

                const rect = content.getBoundingClientRect();
                const pageOffset = window.pageYOffset || document.documentElement.scrollTop;
                const contentTopAbsolute = rect.top + pageOffset;
                if (pageOffset > (contentTopAbsolute + threshold)) arrow.classList.add('visible');
                else arrow.classList.remove('visible');
            }

            content.addEventListener('scroll', updateArrow, { passive: true });
            window.addEventListener('scroll', updateArrow, { passive: true });
            window.addEventListener('resize', updateArrow);
            document.addEventListener('changelog:loaded', updateArrow);

            arrow.addEventListener('click', function(e){
                e.preventDefault();
                if (isContainerScrollable(content)) content.scrollTo({ top: 0, behavior: 'smooth' });
                else window.scrollTo({ top: 0, behavior: 'smooth' });
            });

            document.addEventListener('DOMContentLoaded', updateArrow);
            const observer = new MutationObserver(() => updateArrow());
            observer.observe(content, { childList: true, subtree: true });
        })();
    </script>
</body>
</html>